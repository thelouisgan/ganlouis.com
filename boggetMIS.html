<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Registration System</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        .container {
            max-width: 600px;
            margin: auto;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 10px;
        }
        h1 {
            text-align: center;
        }
        .name-list {
            list-style-type: none;
            padding: 0;
        }
        .name-list li {
            margin: 10px 0;
        }
        .last-seen {
            font-size: 0.9em;
            color: #555;
        }
    </style>
    <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <!-- Add Firebase products that you want to use -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
</head>
<body>

<div class="container">
    <h1>Daily Registration</h1>
    <form id="registrationForm">
        <ul class="name-list">
            <li>
                <input type="checkbox" id="Cowger" name="Cowger" onchange="updateTimestamp('Cowger')"> 
                <label for="Cowger">Cowger</label> 
                <span class="last-seen" id="lastSeenCowger"></span>
            </li>
            <li>
                <input type="checkbox" id="Froggy" name="Froggy" onchange="updateTimestamp('Froggy')"> 
                <label for="Froggy">Froggy</label> 
                <span class="last-seen" id="lastSeenFroggy"></span>
            </li>
            <li>
                <input type="checkbox" id="Amber" name="Amber" onchange="updateTimestamp('Amber')"> 
                <label for="Amber">Amber</label> 
                <span class="last-seen" id="lastSeenAmber"></span>
            </li>
            <li>
                <input type="checkbox" id="Pikachu" name="Pikachu" onchange="updateTimestamp('Pikachu')"> 
                <label for="Pikachu">Pikachu</label> 
                <span class="last-seen" id="lastSeenPikachu"></span>
            </li>
            <li>
                <input type="checkbox" id="George" name="George" onchange="updateTimestamp('George')"> 
                <label for="George">George</label> 
                <span class="last-seen" id="lastSeenGeorge"></span>
            </li>
            <li>
                <input type="checkbox" id="Catty" name="Catty" onchange="updateTimestamp('Catty')"> 
                <label for="Catty">Catty</label> 
                <span class="last-seen" id="lastSeenCatty"></span>
            </li>
            <li>
                <input type="checkbox" id="CaptainBarnacles" name="CaptainBarnacles" onchange="updateTimestamp('CaptainBarnacles')"> 
                <label for="CaptainBarnacles">Captain Barnacles</label> 
                <span class="last-seen" id="lastSeenCaptainBarnacles"></span>
            </li>
            <li>
                <input type="checkbox" id="BOGGET" name="BOGGET" onchange="updateTimestamp('BOGGET')"> 
                <label for="BOGGET">BOGGET</label> 
                <span class="last-seen" id="lastSeenBOGGET"></span>
            </li>
            <li>
                <input type="checkbox" id="Rikete" name="Rikete" onchange="updateTimestamp('Rikete')"> 
                <label for="Rikete">Rikete</label> 
                <span class="last-seen" id="lastSeenRikete"></span>
            </li>
            <li>
                <input type="checkbox" id="Ri" name="Ri" onchange="updateTimestamp('Ri')"> 
                <label for="Ri">Ri</label> 
                <span class="last-seen" id="lastSeenRi"></span>
            </li>
            <li>
                <input type="checkbox" id="Chacha" name="Chacha" onchange="updateTimestamp('Chacha')"> 
                <label for="Chacha">Cha cha</label> 
                <span class="last-seen" id="lastSeenChacha"></span>
            </li>
            <li>
                <input type="checkbox" id="Ariel" name="Ariel" onchange="updateTimestamp('Ariel')"> 
                <label for="Ariel">Ariel</label> 
                <span class="last-seen" id="lastSeenAriel"></span>
            </li>
            <li>
                <input type="checkbox" id="Snowy" name="Snowy" onchange="updateTimestamp('Snowy')"> 
                <label for="Snowy">Snowy</label> 
                <span class="last-seen" id="lastSeenSnowy"></span>
            </li>
            <li>
                <input type="checkbox" id="Doggy" name="Doggy" onchange="updateTimestamp('Doggy')"> 
                <label for="Doggy">Doggy</label> 
                <span class="last-seen" id="lastSeenDoggy"></span>
            </li>
            <li>
                <input type="checkbox" id="Beary" name="Beary" onchange="updateTimestamp('Beary')"> 
                <label for="Beary">Beary</label> 
                <span class="last-seen" id="lastSeenBeary"></span>
            </li>
            <li>
                <input type="checkbox" id="Baymax" name="Baymax" onchange="updateTimestamp('Baymax')"> 
                <label for="Baymax">Baymax</label> 
                <span class="last-seen" id="lastSeenBaymax"></span>
            </li>
            <li>
                <input type="checkbox" id="Paddington" name="Paddington" onchange="updateTimestamp('Paddington')"> 
                <label for="Paddington">Paddington</label> 
                <span class="last-seen" id="lastSeenPaddington"></span>
            </li>
            <li>
                <input type="checkbox" id="Tapir" name="Tapir" onchange="updateTimestamp('Tapir')"> 
                <label for="Tapir">Tapir</label> 
                <span class="last-seen" id="lastSeenTapir"></span>
            </li>
            <li>
                <input type="checkbox" id="Bwaly" name="Bwaly" onchange="updateTimestamp('Bwaly')"> 
                <label for="Bwaly">Bwaly</label> 
                <span class="last-seen" id="lastSeenBwaly"></span>
            </li>
        </ul>
    </form>
</div>

<script>
    // Firebase configuration
    const firebaseConfig = {
        apiKey: "YOUR_API_KEY",
        authDomain: "YOUR_AUTH_DOMAIN",
        databaseURL: "YOUR_DATABASE_URL",
        projectId: "YOUR_PROJECT_ID",
        storageBucket: "YOUR_STORAGE_BUCKET",
        messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
        appId: "YOUR_APP_ID",
        measurementId: "YOUR_MEASUREMENT_ID"
    };
    
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);

    // Function to format timestamp
    function formatTimestamp(timestamp) {
        const now = new Date();
        const date = new Date(timestamp * 1000);
        const diff = now - date;
        const seconds = Math.floor(diff / 1000);
        const minutes = Math.floor(seconds / 60);
        const hours = Math.floor(minutes / 60);
        const days = Math.floor(hours / 24);

        if (seconds < 60) return "just now";
        if (minutes < 60) return minutes + " minute" + (minutes > 1 ? "s" : "") + " ago";
        if (hours < 24) return hours + " hour" + (hours > 1 ? "s" : "") + " ago";
        if (days < 2) return "yesterday";
        if (days < 7) return days + " day" + (days > 1 ? "s" : "") + " ago";
        
        const options = { month: 'short', day: 'numeric' };
        return date.toLocaleDateString(undefined, options);
    }

    function updateTimestamp(name) {
        const timestamp = Math.floor(Date.now() / 1000); // Unix timestamp in seconds
        firebase.database().ref('boggetMIS/' + name).set({
            lastSeen: timestamp
        }).then(() => {
            console.log(name + ' last seen updated to ' + timestamp);
            document.getElementById('lastSeen' + name).innerText = formatTimestamp(timestamp);
        }).catch((error) => {
            console.error('Error updating last seen for ' + name, error);
        });
    }

    function loadLastSeen() {
        const names = [
            "Cowger", "Froggy", "Amber", "Pikachu", "George", "Catty", 
            "CaptainBarnacles", "BOGGET", "Rikete", "Ri", "Chacha", 
            "Ariel", "Snowy", "Doggy", "Beary", "Baymax", "Paddington", 
            "Tapir", "Bwaly"
        ];

        names.forEach(name => {
            firebase.database().ref('boggetMIS/' + name).get().then((snapshot) => {
                if (snapshot.exists()) {
                    const data = snapshot.val();
                    const lastSeenTimestamp = data.lastSeen;
                    document.getElementById('lastSeen' + name).innerText = formatTimestamp(lastSeenTimestamp);
                } else {
                    document.getElementById('lastSeen' + name).innerText = 'No data';
                }
            }).catch((error) => {
                console.error('Error getting last seen for ' + name, error);
            });
        });
    }

    window.onload = function() {
        loadLastSeen();
    }
</script>

</body>
</html>
